{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// pixabay-api.js\n\nimport axios from 'axios';\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"46827902-d0f0ee0995e79e4196197bc56\";\nconst PER_PAGE = 15;\n\nexport async function fetchData(query, page) {\n    const params = {\n        key: API_KEY,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        q: query,\n        page: page,\n        per_page: PER_PAGE\n    };\n\n    try {\n        const response = await axios.get(BASE_URL, { params });\n        return response.data;\n    } catch (error) {\n        throw new Error(\"Failed to fetch images\");\n    }\n}\n","\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Функция для создания HTML-разметки для массива изображений\nexport function createMarkup(arr) {\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"list__item\">\n            <a href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"list__image\"/>\n            </a>\n            <div class=\"info\">\n                <p class=\"info-item\"><b>Likes:</b> ${likes}</p>\n                <p class=\"info-item\"><b>Views:</b> ${views}</p>\n                <p class=\"info-item\"><b>Comments:</b> ${comments}</p>\n                <p class=\"info-item\"><b>Downloads:</b> ${downloads}</p>\n            </div>\n        </li>`\n    ).join(\"\");\n}\n\n// Функция для инициализации SimpleLightbox\nexport function initializeLightbox() {\n    const lightbox = new SimpleLightbox('.list a', {\n        captionDelay: 250,\n        captionsData: 'alt',\n    });\n    lightbox.refresh();\n}\n\n// Функция для отображения ошибок с использованием iziToast\nexport function showError(message) {\n    iziToast.error({\n        title: \"Error\",\n        message: message,\n        position: 'topRight'\n    });\n}\n\n// Функция для отображения информации с использованием iziToast\nexport function showInfo(message) {\n    iziToast.info({\n        title: \"Info\",\n        message: message,\n        position: 'topRight'\n    });\n}\n","\nimport { fetchData } from './js/pixabay-api.js';\nimport { createMarkup, initializeLightbox, showError, showInfo } from './js/render-functions.js';\n\nconst PER_PAGE = 15;\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\nlet loadedHits = 0;\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    const form = document.querySelector(\".form\");\n    const container = document.querySelector(\".list\");\n    const title = document.querySelector(\".title\");\n    const title_second = document.querySelector(\".title_second\");\n\n    const loadMoreBtn = document.querySelector(\".loadMoreBtn\");\n\n    form.addEventListener(\"submit\", handleSearch);\n    loadMoreBtn.addEventListener(\"click\", handleLoadMore);\n\n    // Обработчик сабмита формы поиска изображений\n    async function handleSearch(event) {\n        event.preventDefault();\n\n        const query = event.target.elements.search.value.trim();\n        if (!query) {\n            showError(\"Please enter a search term!\");\n            return;\n        }\n\n        currentQuery = query;\n        currentPage = 1;\n        container.innerHTML = \"\";\n        title.textContent = \"Loading images, please wait...\";\n        loadMoreBtn.classList.remove(\"visible\"); // Скрыть кнопку \"Load more\" перед поиском\n        loadedHits = 0;\n\n        try {\n            const data = await fetchData(query, currentPage);\n            totalHits = data.totalHits;\n            loadedHits += data.hits.length;\n\n            if (data.hits.length === 0) {\n                showError(\"No images found. Try another search term.\");\n            } else {\n                container.innerHTML = createMarkup(data.hits);\n                initializeLightbox();\n                if (loadedHits < totalHits) {\n                    loadMoreBtn.classList.add(\"visible\"); // Показываем кнопку \"Load more\", если есть больше изображений\n                }\n            }\n        } catch (error) {\n            showError(\"Failed to fetch images. Please try again later!\");\n        } finally {\n            title.textContent = \"\";\n            event.target.reset();\n        }\n    }\n\n    // Обработчик кнопки \"Load more\" для подгрузки следующей страницы изображений\n    async function handleLoadMore() {\n        currentPage += 1;\n        title_second.textContent = \"Loading images, please wait...\";\n\n        try {\n            const data = await fetchData(currentQuery, currentPage);\n            loadedHits += data.hits.length;\n\n            if (data.hits.length === 0 || loadedHits >= totalHits) {\n                showInfo(\"We're sorry, but you've reached the end of search results.\");\n                loadMoreBtn.classList.remove(\"visible\"); // Скрываем кнопку, если больше нет изображений\n            } else {\n                container.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n                initializeLightbox();\n\n\n                // Прокрутка страницы после загрузки новых изображений\n                const firstCard = document.querySelector(\".list__item\"); // Находим первую карточку\n                const cardHeight = firstCard.getBoundingClientRect().height; // Получаем высоту карточки\n\n                // Прокручиваем страницу на две высоты карточки\n                window.scrollBy({\n                    top: cardHeight * 2,\n                    behavior: \"smooth\"\n                });\n            title_second.textContent = \"\";\n\n            }\n        } catch (error) {\n            showError(\"Failed to fetch images. Please try again later!\");\n        }\n    }\n});\n"],"names":["BASE_URL","API_KEY","PER_PAGE","fetchData","query","page","params","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","initializeLightbox","SimpleLightbox","showError","message","iziToast","showInfo","currentPage","currentQuery","totalHits","loadedHits","form","container","title","title_second","loadMoreBtn","handleSearch","handleLoadMore","event","data","cardHeight"],"mappings":"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"}